```
▙▗▌   ▜              ▞▀▖      ▜       ▗         ▛▀▘                     ▐     ▌  ▜    
▌▘▌▝▀▖▐▌  ▌▝▀▖▙▀▖▞▀▖ ▙▄▌▛▀▖▝▀▖▐ ▌ ▌▞▀▘▄ ▞▀▘ ▄▄▖ ▙▄ ▞▀▌▞▀▌▄▄▖▚▗▘▞▀▖▞▀▖▌ ▌▜▀ ▝▀▖▛▀▖▐ ▞▀▖
▌ ▌▞▀▌▐▐▐▐ ▞▀▌▌  ▛▀  ▌ ▌▌ ▌▞▀▌▐ ▚▄▌▝▀▖▐ ▝▀▖     ▌  ▚▄▌▚▄▌   ▗▚ ▛▀ ▌ ▖▌ ▌▐ ▖▞▀▌▌ ▌▐ ▛▀ 
▘ ▘▝▀▘ ▘▘▘ ▝▀▘▘  ▝▀▘ ▘ ▘▘ ▘▝▀▘ ▘▗▄▘▀▀ ▀▘▀▀      ▀▀▘▗▄▘▗▄▘   ▘ ▘▝▀▘▝▀ ▝▀▘ ▀ ▝▀▘▀▀  ▘▝▀▘
```
In this THM room, we discover some common tooling for malware analysis within a sandbox
environment. [^1]

Static analysis: What is the SHA256Sum of the HopHelper.exe?
-----------------------------------------------------------------------------------------
In the static malware analysis, we inspect a file without executing it, where as in the
dynamic analysis, we inspect it at runtime in a sandboxed environment. Some of the useful
information gathered from static analysis, is checksums, strings, imports and resources.
First, we want to compute the SHA256 checksum which can be used to track the potentially
malicious executable with the PeStudio Malware Initial Assessment. After opening the
`HopHelper.exe` in the `HopHelper` directory on the desktop in PeStudio we navigate to
the first entry in the list of information, and directly see the SHA256 sum indicator.

Static analysis: Find the flag within the strings of HopHelper.exe.
-----------------------------------------------------------------------------------------
Next, we proceed to the strings tab in PeStudio and can see a table with the size in
bytes, the value of the string, an offset, and more. Since, a majority of the strings as
we can skim it, are very small and of not interest, we can reverse sort the table entries
by size and then examine the first values. Since, we know that the format of the flag is
`THM{XXXXX}`, we could also sort the value entries alphabetically. Either way, after a
bit of searching, we can find the flag within the list of string values. This flag is
also listed under the comments in the version and file description of the malicious
executable.

Dynamic analysis: Name the registry value that the HopHelper.exe modified.
-----------------------------------------------------------------------------------------
In the interactive part of the malware analysis, we want to use Regshot, which works by
creating two snapshots of the registry, one before the malware is run and another
afterwards, and then compares the two states. Upon starting Regshot, we are given the
option to compare logs saved as plain TXT or as a HTML document. Here, we can choose
either and then select the output path to the `C:\Users\DFIRUser\Desktop` path for the
first shot. Then, after the first shot, we run the malware in our sandboxed environment
and notice some files appearing on our desktop and a message by the malware creator.
Now, we can prepare the second shot with the same output path and compare the two shots
afterwards. We want to look for a `RUN` key in the registry now that is an indicator for
malware to establish persistence. And indeed, if we search for the `HopHelper` keyword
in the logging information, we can disclose the registry value that has been modified.

Dynamic analysis: What network protocol is it using for communication?
-----------------------------------------------------------------------------------------
For this task, we utilize the process monitor ProcMon from the Sysinternals suite. Again,
we want to make sure the malware is run while this monitor is open and then stop the
process capturing. First, we want to apply a filter that only shows events from the
`Process Name` "HopHelper.exe" and then another filter to show all `Operations` that
include the "TCP" keyword. This way, we can easily identify some HTTP requests and
responses.

Bonus: Can you find the web panel that HopHelper.exe is communicating with?
-----------------------------------------------------------------------------------------
If we click on the even properties of the TCP connect operation for example, we can see
the path leads to a presumable website `breachblocker-sandbox:http`, so we have a look at
this website in the victim machine's browser (it is not publicly accessible) under the
link `http[://]breachblocker-sandbox` and get rewarded with a System Information
Collector. The logging information listed here, collects the timestamp, hostname,
username, OS, version and computer architecture of every successful run. There are even
more details on the process, antivirus and client IP in the action details.

[^1]: https://tryhackme.com/room/malware-sandbox-aoc2025-SD1zn4fZQt
