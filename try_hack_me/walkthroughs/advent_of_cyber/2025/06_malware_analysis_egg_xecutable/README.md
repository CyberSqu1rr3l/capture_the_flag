```
▙▗▌   ▜              ▞▀▖      ▜       ▗         ▛▀▘                     ▐     ▌  ▜    
▌▘▌▝▀▖▐▌  ▌▝▀▖▙▀▖▞▀▖ ▙▄▌▛▀▖▝▀▖▐ ▌ ▌▞▀▘▄ ▞▀▘ ▄▄▖ ▙▄ ▞▀▌▞▀▌▄▄▖▚▗▘▞▀▖▞▀▖▌ ▌▜▀ ▝▀▖▛▀▖▐ ▞▀▖
▌ ▌▞▀▌▐▐▐▐ ▞▀▌▌  ▛▀  ▌ ▌▌ ▌▞▀▌▐ ▚▄▌▝▀▖▐ ▝▀▖     ▌  ▚▄▌▚▄▌   ▗▚ ▛▀ ▌ ▖▌ ▌▐ ▖▞▀▌▌ ▌▐ ▛▀ 
▘ ▘▝▀▘ ▘▘▘ ▝▀▘▘  ▝▀▘ ▘ ▘▘ ▘▝▀▘ ▘▗▄▘▀▀ ▀▘▀▀      ▀▀▘▗▄▘▗▄▘   ▘ ▘▝▀▘▝▀ ▝▀▘ ▀ ▝▀▘▀▀  ▘▝▀▘
```
In this THM room, we discover some common tooling for malware analysis within a sandbox
environment. [^1]

Static analysis: What is the SHA256Sum of the HopHelper.exe?
-----------------------------------------------------------------------------------------
In the static malware analysis, we inspect a file without executing it, where as in the
dynamic analysis, we inspect it at runtime in a sandboxed environment. Some of the useful
information gathered from static analysis, is checksums, strings, imports and resources.
First, we want to compute the SHA256 checksum which can be used to track the potentially
malicious executable with the PeStudio Malware Initial Assessment. After opening the
`HopHelper.exe` in the `HopHelper` directory on the desktop in PeStudio we navigate to
the first entry in the list of information, and directly see the SHA256 sum indicator.

Static analysis: Find the flag within the strings of HopHelper.exe.
-----------------------------------------------------------------------------------------
Next, we proceed to the strings tab in PeStudio and can see a table with the size in
bytes, the value of the string, an offset, and more. Since, a majority of the strings as
we can skim it, are very small and of not interest, we can reverse sort the table entries
by size and then examine the first values. Since, we know that the format of the flag is
`THM{XXXXX}`, we could also sort the value entries alphabetically. Either way, after a
bit of searching, we can find the flag within the list of string values. This flag is
also listed under the comments in the version and file description of the malicious
executable.

Dynamic analysis: Name the registry value that the HopHelper.exe modified.
-----------------------------------------------------------------------------------------
In the interactive part of the malware analysis, we want to use Regshot, which works by
creating two snapshots of the registry, one before the malware is run and another
afterwards, and then compares the two states.

What registry value has the HopHelper.exe modified for persistence?
Note: Provide the full path of the key that has been modified

Dynamic analysis: What network protocol is it using for communication?
-----------------------------------------------------------------------------------------
Filter the output of ProcMon for "TCP" operations. 
Make sure to have executed HopHelper.exe while ProcMon was open and capturing events.

Bonus: Can you find the web panel that HopHelper.exe is communicating with?
-----------------------------------------------------------------------------------------


[^1]: https://tryhackme.com/room/malware-sandbox-aoc2025-SD1zn4fZQt
